:root {
  /* ===== Core palette (legacy базовые токены) ===== */
  --bg: #0b0f14;
  --panel: #0f1620;
  --panel2: #101a26;
  --line: #223044;
  --text: #cbd5e1;
  --muted: #94a3b8;
  --good: #34d399;
  --warn: #fbbf24;
  --bad: #fb7185;
  --sel: #1f2a3a;
  --focus: #3b82f6;
  --overlay: rgba(0, 0, 0, 0.6);

  /* ===== Typography ===== */
  --mono: "Roboto Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  --sans: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue",
    Arial, sans-serif;
  --font-family: var(--sans);
  --emoji-font: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", "Noto Emoji", "Android Emoji",
    "EmojiOne Color", "Twemoji Mozilla", "Segoe UI Symbol", sans-serif;
  --font-size: 16px;
  --line-height: 1.3125;
  --font-weight: 400;

  /* ===== Spacing scale ===== */
  --sp-1: 4px;
  --sp-2: 6px;
  --sp-3: 8px;
  --sp-4: 10px;
  --sp-5: 12px;
  --sp-6: 18px;

  /* ===== Radii ===== */
  --r-xs: 4px;
  --r-sm: 6px;
  --r-md: 8px;
  --r-lg: 12px;

  /* ===== Borders / focus ===== */
  --border-width: 1px;
  --focus-ring-width: 2px;

  /* ===== Text selection ===== */
  --selection-bg: var(--sel);
  --selection-text: var(--text);

  /* ===== Text caret (cursor) ===== */
  --caret-color: var(--focus);
  --caret-thickness: 2px;
  --caret-radius: 1px;
  --caret-glow: color-mix(in srgb, var(--caret-color), transparent 45%);
  --caret-blink: 1s;

  /* ===== Scrollbar (best-effort, зависит от браузера) ===== */
  --scrollbar-size: 10px;
  --scrollbar-radius: 10px;
  --scrollbar-track: var(--panel);
  --scrollbar-thumb: var(--line);
  --scrollbar-thumb-hover: var(--muted);

  /* ===== App / layout tokens ===== */
  --app-bg: var(--bg);
  --app-text: var(--text);
  --app-muted: var(--muted);

  /* Outer padding around the app (safe-area / margins on mobile). */
  --app-outer-pad: 0px;

  /* App "window" (container) sizing/styling */
  --app-max-width: 100%;
  --app-border-color: transparent;
  --app-border-width: 0px;
  --app-radius: 0px;
  --app-shadow: none;
  --app-overflow: hidden;

  /* App grid rows: header / main / footer (composer lives inside chat column) */
  --app-row-header: auto;
  --app-row-main: 1fr;
  --app-row-composer: auto;
  --app-row-footer: auto;

  /* Main grid columns + gap */
  --grid-cols: var(--sidebar-width) minmax(0, 1fr);
  --grid-gap: 0px;

  --header-bg: var(--panel);
  --header-border-color: var(--line);
  --header-border-width: var(--border-width);
  --header-pad-y: 10px;
  --header-pad-x: 12px;
  --header-gap-y: 6px;
  --header-gap-x: 12px;
  --header-left-color: var(--text);
  --header-right-color: var(--muted);
  --header-label-color: var(--muted);
  --header-id-color: var(--text);
  --header-version-color: var(--muted);
  --header-sep-color: var(--muted);
  --header-title-color: var(--text);
  --header-right-max-width: min(55vw, 520px);

  --hotkeys-gap: var(--sp-2);
  --hotkeys-pad-b: 2px;

  --sidebar-bg: var(--panel);
  --sidebar-border-color: var(--line);
  --sidebar-border-width: var(--border-width);
  --sidebar-pad: 10px;
  --sidebar-width-min: 308px;
  --sidebar-width-max: 420px;
  --sidebar-collapsed-width: 80px;
  --sidebar-width: clamp(var(--sidebar-width-min), var(--current-sidebar-left-width, var(--sidebar-width-max)), var(--sidebar-width-max));

  --chat-bg: var(--bg);
  --chat-pad: 16px;

  --composer-bg: var(--panel);
  /* Background color for iOS safe-area (home indicator zone). Should match the bottom bar. */
  --safe-area-bg: var(--composer-bg);
  --composer-border-color: var(--line);
  --composer-border-width: var(--border-width);
  --composer-pad-y: 10px;
  --composer-pad-x: 12px;
  --composer-gap: 10px;
  --prompt-color: var(--muted);

  --footer-bg: var(--panel);
  --footer-border-color: var(--line);
  --footer-border-width: var(--border-width);
  --footer-pad-y: var(--sp-2);
  --footer-pad-x: var(--sp-4);
  --footer-color: var(--muted);

  /* ===== Controls ===== */
  --field-bg: rgba(255, 255, 255, 0.02);
  --field-border-color: var(--line);
  --field-border-width: var(--border-width);
  --field-text: var(--text);
  --field-radius: 10px;
  --field-pad-y: 10px;
  --field-pad-x: 10px;
  --field-focus-border: var(--focus);
  --field-placeholder: var(--muted);

  /* Chat composer field can be styled separately */
  --composer-field-bg: var(--panel2);
  --composer-field-border-color: var(--line);
  --composer-field-border-width: var(--field-border-width);
  --composer-field-text: var(--field-text);
  --composer-field-radius: 18px;
  --composer-field-pad: var(--sp-2);
  --composer-field-min-h: 44px;
  --composer-field-max-h: 120px;
  --composer-field-focus-border: var(--field-focus-border);
  --composer-field-placeholder: var(--field-placeholder);
  --composer-focus-ring-width: 1px;
  /* Telegram-like: input feels better in system sans, while the rest of UI can stay terminal/mono. */
  --composer-input-font-family: var(--sans);
  /* 16px+ avoids iOS "auto-zoom" on focus */
  --composer-input-font-size: max(var(--font-size), 16px);
  --composer-input-line-height: 1.3125;
  --composer-input-font-weight: 450;
  --composer-input-letter-spacing: 0em;

  /* Send button icon (brand berry) */
  --send-berry-glint: rgba(255, 255, 255, 0.78);
  --send-berry-light: #ff9bb0;
  --send-berry: #ff3b5c;
  --send-berry-dark: #e0163c;
  --send-leaf-light: #66e5a3;
  --send-leaf: #2bbf6f;
  --send-leaf-dark: #1e9e57;
  --send-icon-berry-size: 18px;
  --send-icon-leaf-size: 12px;
  --send-icon-leaf-offset-x: 7px;
  --send-icon-leaf-offset-y: -11px;
  --send-icon-leaf-rotate: 25deg;
  --send-icon-berry-shadow: 0 8px 18px rgba(0, 0, 0, 0.18);
  --send-icon-leaf-shadow: 0 6px 14px rgba(0, 0, 0, 0.12);

  /* Buttons */
  --btn-bg: rgba(255, 255, 255, 0.02);
  --btn-border-color: var(--line);
  --btn-border-width: var(--border-width);
  --btn-text: var(--muted);
  --btn-radius: 10px;
  --btn-pad-y: 8px;
  --btn-pad-x: 10px;
  --btn-bg-hover: var(--panel2);
  --btn-border-hover: var(--btn-border-color);
  --btn-text-hover: var(--text);
  --btn-bg-active: var(--sel);
  --btn-translate-active-y: 1px;

  /* Hotkey buttons (header) */
  --hk-bg: transparent;
  --hk-border-color: var(--line);
  --hk-border-width: var(--border-width);
  --hk-text: var(--muted);
  --hk-radius: var(--r-sm);
  --hk-pad-y: 4px;
  --hk-pad-x: 8px;
  --hk-bg-hover: var(--panel2);
  --hk-text-hover: var(--text);
  --hk-bg-active: var(--sel);

  /* ===== Sidebar rows ===== */
  --row-bg: transparent;
  --row-text: var(--text);
  --row-min-h: 56px;
  --row-pad-y: 7px;
  --row-pad-x: 16px;
  --row-gap: 16px;
  --row-radius: 10px;
  --row-bg-hover: var(--panel2);
  --row-bg-selected: var(--sel);
  --row-text-selected: var(--text);
  --row-text-selected-muted: color-mix(in srgb, var(--text), var(--muted) 40%);
  --row-bg-selected-hover: var(--row-bg-selected);
  --row-text-selected-hover: var(--row-text-selected);
  --row-text-selected-muted-hover: var(--row-text-selected-muted);
  --row-unread-selected-bg: var(--panel);
  --row-unread-selected-text: var(--focus);
  --row-star-color: var(--warn);
  --row-dot-online: var(--good);
  --row-dot-offline: var(--muted);
  --row-prefix-color: var(--muted);

  /* Avatars (local UI only) */
  --avatar-size: 40px;
  --avatar-radius: 999px;
  --avatar-font-size: 14px;
  --avatar-border-color: color-mix(in srgb, var(--line), transparent 15%);
  --avatar-text: #0b0f14;

  --pane-title-color: var(--text);
  --pane-title-mb: var(--sp-3);
  --pane-section-color: var(--muted);
  --pane-section-mt: var(--sp-4);
  --pane-section-mb: var(--sp-2);

  /* ===== Chat messages ===== */
  --chat-title-color: var(--muted);
  --chat-title-mb: var(--sp-3);
  --chat-line-gap: 6px;
  --msg-pad-y: 2px;
  --msg-status-read-color: var(--focus);
  --messages-container-width: 728px;
  --msg-body-max-width: min(78%, var(--messages-container-width));
  --msg-in-justify: flex-start;
  --msg-out-justify: flex-end;
  --msg-sys-justify: flex-start;

  --msg-in-color: var(--text);
  --msg-out-color: var(--text);
  --msg-sys-color: var(--muted);
  --msg-time-color: var(--muted);
  --msg-from-in-color: var(--text);
  --msg-from-out-color: var(--text);
  --msg-sep-color: var(--muted);
  --msg-text-in-color: var(--text);
  --msg-text-out-color: var(--text);

  /* "Bubble" styling for messages */
  --msg-in-bg: var(--panel);
  --msg-in-border-color: var(--line);
  --msg-in-border-width: var(--border-width);
  --msg-in-radius: 18px;
  --msg-in-cont-corner: 10px;
  --msg-in-pad-y: 8px;
  --msg-in-pad-x: 12px;

  --msg-out-bg: var(--panel2);
  --msg-out-border-color: var(--line);
  --msg-out-border-width: var(--border-width);
  --msg-out-radius: 18px;
  --msg-out-cont-corner: 10px;
  --msg-out-pad-y: 8px;
  --msg-out-pad-x: 12px;

  /* ===== Modals ===== */
  --overlay-bg: var(--overlay);
  --overlay-blur: 8px;
  --overlay-pad: var(--sp-6);
  --modal-bg: var(--panel);
  --modal-border-color: var(--line);
  --modal-border-width: var(--border-width);
  --modal-max-width: 620px;
  --modal-max-height: calc(100vh - (var(--overlay-pad) * 2));
  --modal-max-height: calc(100svh - (var(--overlay-pad) * 2));
  --modal-max-height: calc(100dvh - (var(--overlay-pad) * 2));
  --modal-overflow: auto;
  --modal-radius: var(--r-lg);
  --modal-pad: var(--sp-5);
  --modal-shadow: 0 10px 35px rgba(0, 0, 0, 0.5);
  --card-shadow: 0 12px 30px rgba(0, 0, 0, 0.18);
  --modal-title-color: var(--text);
  --modal-line-color: var(--muted);
  --modal-line-mt: 6px;
  --modal-line-mb: 6px;
  --modal-title-mb: 10px;
  --modal-warn-color: var(--warn);
  --modal-warn-mt: 8px;
  --modal-actions-gap: var(--sp-2);
  --modal-actions-mt: 10px;
}

:root[data-msg-view="plain"] {
  --msg-in-bg: transparent;
  --msg-out-bg: transparent;
  --msg-in-border-width: 0;
  --msg-out-border-width: 0;
  --msg-in-pad-y: 0;
  --msg-in-pad-x: 0;
  --msg-out-pad-y: 0;
  --msg-out-pad-x: 0;
  --msg-pad-y: 1px;
  --chat-line-gap: 2px;
  --msg-body-max-width: min(100%, var(--messages-container-width));
  --msg-in-justify: flex-start;
  --msg-out-justify: flex-start;
}

:root[data-msg-view="compact"] {
  --msg-in-bg: transparent;
  --msg-out-bg: transparent;
  --msg-in-border-width: 0;
  --msg-out-border-width: 0;
  --msg-in-pad-y: 0;
  --msg-in-pad-x: 0;
  --msg-out-pad-y: 0;
  --msg-out-pad-x: 0;
  --msg-pad-y: 1px;
  --chat-line-gap: 3px;
  --msg-body-max-width: min(100%, var(--messages-container-width));
  --msg-in-radius: 0;
  --msg-out-radius: 0;
  --msg-in-justify: flex-start;
  --msg-out-justify: flex-start;
  --msg-avatar-size: 0px;
  --msg-avatar-font-size: 0px;
}

:root[data-theme="light"] {
  color-scheme: light;
}

:root[data-theme="dark"] {
  color-scheme: dark;
}
